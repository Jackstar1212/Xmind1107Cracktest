(global.webpackChunkxmind_vana=global.webpackChunkxmind_vana||[]).push([[163],{60708:(e,t,i)=>{"use strict";var s=i(95318);Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var n=s(i(71191)),o=s(i(24678)),r=i(99492),a=s(i(55167)),d=i(65831),c=i(88606),h=i(32118),l=i(58933),u=i(96486);const p="darwin"===process.platform;let w;var f={data:()=>({winId:0,mainId:0,editorId:0,showCursor:!1,slideshow:h.Slideshow,contentProvider:d.SheetSnapshotContentProvider,presentationView:null,myPerspectiveView:null,payload:null,debouncedUpdate:null,debouncedOnResize:null}),created(){document.title=this.$T("Pitch Mode"),this.winId=window.id,this.win=l.remote.getCurrentWindow(),this.debouncedUpdate=(0,u.debounce)(this.viewUpdate,300),this.debouncedOnResize=(0,u.debounce)(this.onResize,200);const e=n.default.parse(window.location.search.slice(1));e.mainid&&(this.mainId=parseInt(e.mainid)),e.editorid&&(this.editorId=e.editorid),e.id&&(this.uniqueId=e.id),window.addEventListener("beforeunload",(()=>{o.default.fetch(r.PITCH_MODE.CONNECT_MAIN(this.mainId,this.editorId,this.uniqueId),!0)})),window.addEventListener("keydown",this.onKeyDown)},beforeDestroy(){window.removeEventListener("keydown",this.onKeyDown),this.win&&(this.win.removeListener("enter-full-screen",this.onEnterFullScreen),this.win.removeListener("leave-full-screen",this.onLeaveFullScreen),this.win.removeListener("resize",this.debouncedOnResize))},mounted(){this.win&&(this.win.on("enter-full-screen",this.onEnterFullScreen),this.win.on("leave-full-screen",this.onLeaveFullScreen),this.win.on("resize",this.debouncedOnResize));(()=>{o.default.fetch(r.PITCH_MODE.CONNECT_MAIN(this.mainId,this.editorId,this.uniqueId)).then((({providerData:e,startingTopicId:t,isDarkTheme:i,animationEnabled:s,aspectRatioOptions:n,currentAspectRatio:o})=>{if(!e)return;const r=JSON.parse(e);this.contentProvider=new d.SheetSnapshotContentProvider(this.$store,null,r),this.payload={startingTopicId:t,isDarkTheme:i,animationEnabled:s,aspectRatioOptions:n,currentAspectRatio:o},this.initSlideShow()}))})()},methods:{initSlideShow(){if(!this.contentProvider||!this.payload)return;const{startingTopicId:e,isDarkTheme:t,animationEnabled:i,aspectRatioOptions:s,currentAspectRatio:n}=this.payload;this.$refs.pitchConatiner.textContent="";const o=new a.default({data:{startFromBeginning:!e,isDarkTheme:t,animationEnabled:i,alwaysShowCursor:!0,aspectRatioOptions:s,currentAspectRatio:n},store:this.$store});o.$mount(),this.presentationView=o.presentationView,this.myPerspectiveView=o,this.presentationView.allowsActivatingPresenterPerspectiveModeViaPointerMovement=!0;const r=this.presentationView.el;r.style.left="0",r.style.top="0",r.style.width="100%",r.style.height="100%",this.presentationView.update(),this.presentationView.connect(),this.$refs.pitchConatiner.appendChild(o.$el);const d=this.contentProvider.isAutomaticRatio?this.computeSuitableRatio():this.contentProvider.aspectRatio;w=d;const c=h.slideSizes[d],l=this.contentProvider.preferredThemeId;if(this.slideshow=new h.Slideshow({contentProvider:this.contentProvider,slideSize:c,slideTheme:l}),this.slideshow.mode="presenterPerspective",this.slideshow.addPresenter(this.presentationView),this.slideshow.present(e).then((()=>{this.slideshow.disablesAnimations=!this.contentProvider.animationEnabled})),o.start(),o.$on("exit",(()=>this.exit())),o.$on("next",(()=>this.next())),o.$on("prev",(()=>this.prev())),o.$on("gotoBeginning",(()=>{this.slideshow.present(null)})),o.$on("toggleTheme",(e=>this.toggleTheme(e))),o.$on("enableAnimation",(e=>this.enableAnimation(e))),o.$on("changeRatio",(e=>this.changeAspectRatio(e))),o.$on("fastforward",(()=>this.fastForward())),o.$on("fastbackward",(()=>this.fastBackward())),this.slideshow.on("finish",(()=>this.exit())),setTimeout((()=>{this.slideshow.on("stateDidChange",(()=>{o.myPerspectiveMode="presenterPerspective"===this.slideshow.mode}))}),300),p&&!this.contentProvider.isAutomaticRatio){const e=this.win.getBounds(),{width:t,height:i}=e;this.win.setAspectRatio(t/i)}},onEnterFullScreen(){this.slideshow&&(this.slideshow.removePresenter(this.presentationView),this.slideshow.addPresenter(this.presentationView)),this.debouncedUpdate()},onLeaveFullScreen(){this.slideshow&&(this.slideshow.removePresenter(this.presentationView),this.slideshow.addPresenter(this.presentationView)),this.debouncedUpdate()},onResize(){let e=this.contentProvider.aspectRatio;if(this.contentProvider.isAutomaticRatio&&(e=this.computeSuitableRatio()),e!==w){w=e;const t=h.slideSizes[e];this.slideshow.changeSlideSize(t)}else this.viewUpdate()},viewUpdate(){this.presentationView&&this.presentationView.update()},exit(){this.win.close()},next(){this.slideshow.forward()},prev(){this.slideshow.backward()},fastForward(){this.slideshow.fastForward()},fastBackward(){this.slideshow.fastBackward()},toggleTheme(e){this.contentProvider.preferredThemeId=e,this.slideshow.changeSlideTheme(e)},enableAnimation(e){this.contentProvider.animationEnabled=e,this.slideshow.disablesAnimations=!e},computeSuitableRatio(){if(!this.win)return"16:9";const e=this.win.getBounds(),t=e.width/e.height;let i="16:9",s=1/0;for(const e of Object.keys(h.slideSizes)){if(!/\d+:\d+/.test(e))continue;const n=e.split(":").map((e=>Number(e))),o=Math.abs(n[0]/n[1]-t);o<s&&(s=o,i=e)}return i},changeAspectRatio(e){this.myPerspectiveView.hideSettingsPopover(),this.contentProvider.aspectRatio=e;const t=(0,c.computeWindowSize)(e);if(this.win.setMinimumSize(360,360),this.win.setBounds(t),p)if(this.contentProvider.isAutomaticRatio)this.win.setAspectRatio(0);else{const{width:e,height:i}=t;this.win.setAspectRatio(e/i),this.win.setMinimumSize(t.minWidth,t.minHeight)}},onMouseDown(){this.$el.focus()},onKeyDown(e){const{altKey:t,ctrlKey:i,metaKey:s,shiftKey:n}=e;this.handleKeydownEvent(e.key,{altKey:t,ctrlKey:i,metaKey:s,shiftKey:n})&&e.stopPropagation()},handleKeydownEvent(e,t){switch(e){case"PageDown":case"ArrowDown":case"Enter":case" ":return this.next(),!0;case"ArrowRight":return t.shiftKey?this.fastForward():this.next(),!0;case"PageUp":case"ArrowUp":return this.prev(),!0;case"ArrowLeft":return t.shiftKey?this.fastBackward():this.prev(),!0;case"Escape":case"q":case"Q":return this.exit(),!0;case"a":case"A":return this.myPerspectiveView.animationEnabled=!this.myPerspectiveView.animationEnabled,!0;case"/":case"?":return this.myPerspectiveView.isShortcutsListEnabled=!this.myPerspectiveView.isShortcutsListEnabled,!0}}}};t.Z=f},43183:(e,t,i)=>{"use strict";var s=i(95318),n=s(i(2872)),o=s(i(16641)),r=s(i(60379)),a=s(i(20144)),d=s(i(21821));a.default.directive("focus-contexts",{}),(0,n.default)(d.default,{name:"presentationwindowed",storeModules:{fonts:r.default},storePlugins:[(0,o.default)()]})},60379:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i(99492),n=i(24678);let o;var r={namespaced:!0,state:{loaded:!1},mutations:{markLoaded:e=>{e.loaded=!0}},actions:{getLoadedFonts:()=>(o||(o=(0,n.fetch)(s.GET_ALL_FONTS)),o)}};t.default=r},16641:(e,t,i)=>{"use strict";var s=i(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(i(59713)),o=i(78835),r=s(i(98756)),a=i(53305);function d(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function c(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?d(Object(i),!0).forEach((function(t){(0,n.default)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):d(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}const h="static/fonts/fonts.json";t.default=()=>e=>{(async function(){let e=await(0,a.load)(h),t=JSON.parse(e),i=[];const s=(0,a.toURL)(h);for(let e in t){let n=t[e];for(let{src:t,weight:r,italic:a}of n){let n=new o.URL(t,s).toString(),d=new FontFace(e,`url("${n}")`,c({weight:r},a?{style:"italic"}:{}));document.fonts.add(d),d.load(),i.push(d.loaded)}}await Promise.all(i)})().then((()=>{e.commit("fonts/markLoaded")})).catch((e=>{throw(0,r.default)(new Error("Failed to load CSS fonts"),e)})),document.fonts.onloadingdone=()=>{e.commit("fonts/markLoaded")},document.fonts.onloadingerror=()=>{e.commit("fonts/markLoaded")}}},31139:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var s=i(94015),n=i.n(s),o=i(23645),r=i.n(o)()(n());r.push([e.id,"\nbody,\n#app {\n  background: black;\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  padding: 0;\n  margin: 0;\n  overflow: hidden;\n}\n","",{version:3,sources:["webpack://./app/renderer/pages/presentationwindowed/app.vue"],names:[],mappings:";AACA;;EAEE,iBAAiB;EACjB,WAAW;EACX,YAAY;EACZ,kBAAkB;EAClB,OAAO;EACP,MAAM;EACN,UAAU;EACV,SAAS;EACT,gBAAgB;AAClB",sourcesContent:["\nbody,\n#app {\n  background: black;\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  padding: 0;\n  margin: 0;\n  overflow: hidden;\n}\n"],sourceRoot:""}]);const a=r},930:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var s=i(94015),n=i.n(s),o=i(23645),r=i.n(o)()(n());r.push([e.id,"\n.uk-pop-overlay {\n  display: none !important;\n}\n","",{version:3,sources:["webpack://./app/renderer/pages/presentationwindowed/app.vue"],names:[],mappings:";AACA;EACE,wBAAwB;AAC1B",sourcesContent:["\n.uk-pop-overlay {\n  display: none !important;\n}\n"],sourceRoot:""}]);const a=r},21821:(e,t,i)=>{"use strict";i.r(t),i.d(t,{__esModule:()=>s.X,default:()=>o});var s=i(60708);var n=function(e){i(42194),i(277)};const o=(0,i(62236).Z)(s.Z,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"app"}},[i("div",{staticClass:"uk-window-title-bar",staticStyle:{"-webkit-app-region":"drag",position:"fixed",top:"0",width:"100%",left:"0","z-index":"10"},on:{click:function(e){e.stopPropagation(),e.preventDefault()}}}),e._v(" "),i("div",{ref:"pitchConatiner"})])}),[],!1,n,null,null).exports},42194:(e,t,i)=>{var s=i(31139);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);(0,i(45346).Z)("28e88b96",s,!0,{})},277:(e,t,i)=>{var s=i(930);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);(0,i(45346).Z)("394b3236",s,!0,{})},76417:e=>{"use strict";e.exports=require("crypto")},58933:e=>{"use strict";e.exports=require("electron")},28614:e=>{"use strict";e.exports=require("events")},35747:e=>{"use strict";e.exports=require("fs")},12087:e=>{"use strict";e.exports=require("os")},85622:e=>{"use strict";e.exports=require("path")},87525:e=>{"use strict";e.exports=require("posthtml")},71191:e=>{"use strict";e.exports=require("querystring")},92413:e=>{"use strict";e.exports=require("stream")},78835:e=>{"use strict";e.exports=require("url")},31669:e=>{"use strict";e.exports=require("util")}},e=>{"use strict";e.O(0,[8388,8592,5586,4736,2872,8606],(()=>{return t=43183,e(e.s=t);var t}));var t=e.O();module.exports=t}]);