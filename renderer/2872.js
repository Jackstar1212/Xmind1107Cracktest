(global.webpackChunkxmind_vana=global.webpackChunkxmind_vana||[]).push([[2872],{90932:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={install(e){e.prototype.$T=function(e,...t){return this.$store.getters["l10n/T"](e,...t)}}};t.default=n},68290:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={install(e){const t="vana-ref";e.directive(t,{bind:function(e,t,n){t.value(n.componentInstance||e,n.key)},update:function(e,n,r,a){if(a.data&&a.data.directives){var o=a.data.directives.find((function(e){return e.name===t}));if(o&&o.value!==n.value)return o&&o.value(null,a.key),void n.value(r.componentInstance||e,r.key)}r.componentInstance===a.componentInstance&&r.elm===a.elm||n.value(r.componentInstance||e,r.key)},unbind:function(e,t,n){t.value(null,n.key)}})}};t.default=n},97226:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(53305),a={install(e){e.prototype.$toResourceURL=(...e)=>(0,r.toURL)(...e).replace("(","%28").replace(")","%29"),e.prototype.$loadResource=r.load}};t.default=a},54828:(e,t,n)=>{"use strict";var r=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(36414);const o=(0,r(n(41698)).default)("safe-runner");var i=class{constructor(e){this.errorHandler=e}_handleError(e){"function"==typeof this.errorHandler?this.errorHandler(e):o.error((0,a.normalizeError)(e))}install(e){const t=this;e.prototype.$safeRun=function(e){try{let n=e();return n&&n.then&&n.catch?n.then((e=>e)).catch((e=>t._handleError(e))):n}catch(e){t._handleError(e)}}}};t.default=i},2872:(e,t,n)=>{"use strict";var r=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=async function(e,{mountTarget:t="#app",name:n=null,plugins:r=[],storeModules:a={},storePlugins:o=[]}={}){L.debug("Bootstrapping:",x);for(let e of r)i.default.use(e);const d={},c={};T||(d.window=w.default,c.window=(0,h.WINDOW_SHARED_WITH_ID)(window.id));n in m.default&&(d[n]=m.default[n],c[n]=(0,h.WINDOW_WITH_NAME_AND_ID)(n,window.id));for(let[e,t]of Object.entries(a))"remoteNamespace"in t&&(d[e]=t,c[e]=t.remoteNamespace);const u=new s.Store({state:{forceUpdateTrigger:{}},mutations:{forceUpdate(e){e.forceUpdateTrigger={}}},modules:C(C(C({},p.default),d),a),plugins:[...g.default.map((e=>e({ipc:b.default,revents:y.default}))),(0,M.default)(),(0,k.default)({modules:C(C({},p.default),d),namespaceMapping:c}),(0,A.default)(),(0,j.default)(),...o]});let l;return await new Promise((n=>{setTimeout((()=>{L.debug("About to create Vue instance:",x),l=new i.default(C(C({},e),{},{store:u})),L.debug("Created Vue instance:",x),window.addEventListener("unload",(()=>{window.isBeingDestroyed=!0,l.$destroy(),window.isDestroyed=!0}));let r=u.watch((e=>e.bootstrap.ready),(e=>{e&&(r(),L.debug("About to mount Vue instance:",x),l.$mount(t||"#app"),L.debug("Mounted Vue instance:",x),setTimeout((()=>{"function"==typeof window.show&&(window.show(),window.isShown=!0)}),200))}));n(l)}),0)})),l};var a=r(n(59713)),o=r(n(62255)),i=r(n(20144)),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=D(t);if(n&&n.has(e))return n.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var i=a?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(r,o,i):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(20629)),d=r(n(71191)),c=n(58933),u=r(n(95588)),l=r(n(30266)),f=r(n(41698)),p=r(n(81779)),w=r(n(79591)),m=r(n(75683)),h=n(90336),g=r(n(52910)),y=r(n(79914)),v=r(n(58587)),b=r(n(24678)),E=r(n(90571)),P=r(n(68290)),O=r(n(90932)),_=r(n(54828)),S=r(n(97226)),M=r(n(50766)),k=r(n(29781)),A=r(n(96310)),j=r(n(80969));function D(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(D=function(e){return e?n:t})(e)}function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){(0,a.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const T=!!d.default.parse(window.location.search.slice(1)).isBrowserView,x=window.location.pathname.match(/\/([a-zA-Z0-9-]+)\.html$/)[1]||"default",L=(0,f.default)("performance");L.debug("Initializing page:",x),c.webFrame.setVisualZoomLevelLimits(1,1),"darwin"===process.platform?document.body.classList.add("uk-darwin"):"win32"===process.platform?document.body.classList.add("uk-win32"):"linux"===process.platform&&document.body.classList.add("uk-linux"),T&&(c.remote.getCurrentWindow=function(){const e=v.default.sendSync("get-current-window-id");return c.remote.BrowserWindow.fromId(e)}),Object.defineProperty(window,"id",{get:()=>c.remote.getCurrentWindow().id});const R=i.default.observable({isBeingDestroyed:!1,isDestroyed:!1,isShown:!1});["isBeingDestroyed","isDestroyed","isShown"].forEach((e=>{Object.defineProperty(window,e,{get:()=>R[e],set(t){R[e]=t}})})),window.show=()=>{c.remote.getCurrentWindow().show()},window.hide=()=>{c.remote.getCurrentWindow().hide()},window.close=()=>{c.remote.getCurrentWindow().close()},window.minimize=()=>{c.remote.getCurrentWindow().minimize()},window.maximize=()=>{c.remote.getCurrentWindow().maximize()},window.restore=()=>{c.remote.getCurrentWindow().unmaximize()},window.isMinimized=()=>c.remote.getCurrentWindow().isMinimized(),window.isMaximized=()=>c.remote.getCurrentWindow().isMaximized(),window.isFullScreen=()=>c.remote.getCurrentWindow().isFullScreen(),window.resizeTo=(e,t)=>{c.remote.getCurrentWindow().setContentSize(e,t)},window.resizeBy=(e,t)=>{let[n,r]=c.remote.getCurrentWindow().getContentSize();c.remote.getCurrentWindow().setContentSize(n+e,r+t)},window.moveTo=(e,t)=>{c.remote.getCurrentWindow().setPosition(e,t)},window.moveBy=(e,t)=>{let[n,r]=c.remote.getCurrentWindow().getPosition();c.remote.getCurrentWindow().setPosition(n+e,r+t)},y.default.on("window-maximize",(()=>{document.body.classList.add("uk-window-maximized"),window.dispatchEvent(new Event("maximize"))})),y.default.on("window-unmaximize",(()=>{document.body.classList.remove("uk-window-maximized"),window.dispatchEvent(new Event("restore"))})),y.default.on("window-minimize",(()=>{window.dispatchEvent(new Event("minimize"))})),y.default.on("window-unminimize",(()=>{window.dispatchEvent(new Event("unminimize"))})),y.default.on("window-focus",(()=>{document.body.classList.remove("uk-window-inactive")})),y.default.on("window-blur",(()=>{document.body.classList.add("uk-window-inactive")})),y.default.on("window-enter-full-screen",(()=>{document.body.classList.add("uk-window-full-screen"),window.dispatchEvent(new Event("enter-full-screen"))})),y.default.on("window-leave-full-screen",(()=>{document.body.classList.remove("uk-window-full-screen"),window.dispatchEvent(new Event("leave-full-screen"))})),y.default.on("window-sheet-begin",(()=>{window.dispatchEvent(new Event("sheet-begin"))})),y.default.on("window-sheet-end",(()=>{window.dispatchEvent(new Event("sheet-end"))})),y.default.on("window-show",(()=>{window.dispatchEvent(new Event("window-show"))}));const $=c.remote.getCurrentWindow();if($.isMaximized()&&document.body.classList.add("uk-window-maximized"),$.isFullScreen()&&document.body.classList.add("uk-window-full-screen"),$.isFocused()||document.body.classList.add("uk-window-inactive"),document.addEventListener("keydown",(e=>{27===e.keyCode&&document.body.querySelector(".uk-window-dialog")&&setTimeout((()=>{if(e.defaultPrevented)return;const t=new Event("close");window.dispatchEvent(t)&&window.close()}),0)})),$.isMaximizable&&$.isMaximizable()){const e=["a","button","select","input"];document.addEventListener("dblclick",(t=>{const{target:n,defaultPrevented:r}=t;if(r)return;let a=n;for(;a&&"function"==typeof a.matches;){if(e.some((e=>a.matches(e))))return;a=a.parentNode}let o=document.querySelector(".uk-window-expanded-title-bar")||document.querySelector(".uk-window-title-bar");o&&o.contains(n)&&(window.isMaximized()?window.restore():window.maximize())}))}i.default.use(E.default),i.default.use(new _.default((e=>o.default.handle(e)))),i.default.use(u.default),i.default.use(s),i.default.use(O.default),i.default.use(S.default),i.default.use(P.default),i.default.use(l.default.Plugin),L.debug("Initialized page:",x)},62255:(e,t,n)=>{"use strict";var r=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(59714),o=r(n(41698)),i=r(n(24678));const s=window.location.pathname.match(/\/([a-zA-Z0-9-]+)\.html$/)[1]||"default",d=(0,o.default)(`error:${s}`),c=new a.ErrorHandler(d,{ipc:i.default});window.addEventListener("error",(function(e){const t=e.error;t&&c.handle(t)})),window.addEventListener("unhandledrejection",(function(e){const t=e.reason;t&&c.handle(t)}));var u=c;t.default=u},95287:(e,t,n)=>{"use strict";var r=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.showMessageBox=async function(e){(e=Object.assign({},e||{})).icon&&"string"==typeof e.icon&&(e.icon=a.default.join((0,i.getAppPath)(),e.icon));const{response:t,checkboxChecked:n}=await o.remote.dialog.showMessageBox(o.remote.getCurrentWindow(),e);return[t,n]},t.showSaveDialog=async function(e){e=Object.assign({securityScopedBookmarks:!0},e||{});let t=null;e.suggestPath&&!e.defaultPath&&(t=e.suggestPath.store,e.defaultPath=u(e.suggestPath,e.filters),delete e.suggestPath);const{canceled:n,filePath:r,bookmark:i}=await o.remote.dialog.showSaveDialog(o.remote.getCurrentWindow(),e);if(n)return null;r&&i&&await d.default.bindBookmark({fp:r,bookmark:i});r&&t&&t.commit("editors/setLastSaveDirectory",{dir:a.default.dirname(r)});return r},t.suggestSavePath=u;var a=r(n(85622)),o=n(58933),i=n(6921),s=r(n(41698)),d=r(n(86554));const c=(0,s.default)("dialog");function u({doc:e=null,oldDoc:t=null,suggestedName:n=null,store:r=null,workbook:i=null,sheet:s=null},d=null){let u,l;if(!u&&n&&(u=n.toString().replace(/(\r\n|\n|\r)+/gm," ")),!u&&e&&e.title&&e.source&&!e.source.startsWith("new://")&&(u=e.title.toString().replace(/(\r\n|\n|\r)+/gm," ")),!u&&t&&t.title&&t.source&&!t.source.startsWith("new://")&&(u=t.title.toString().replace(/(\r\n|\n|\r)+/gm," ")),!u&&(s||i)&&(s=s||i.getSheetByIndex(0))){const e=s.rootTopic().attributes;e&&e.title?u=e.title.toString().replace(/(\r\n|\n|\r)+/gm," "):s.attributes&&s.attributes.title&&(u=s.attributes.title.toString().replace(/(\r\n|\n|\r)+/gm," "))}if(u&&Array.isArray(d)){const e=d[0]&&d[0].extensions;Array.isArray(e)&&e.length>0&&(u=`${u}.${e[0]}`)}if(!l&&t&&t.source&&t.source.startsWith("file://")){let e=t.source.slice(7);"win32"===process.platform&&(e=e.substring(1)),l=a.default.dirname(e)}if(!l&&r&&r.state.editors.lastSaveDirectory&&(l=r.state.editors.lastSaveDirectory),!l)try{l=o.remote.app.getPath("documents")}catch(e){c.info(e)}return l&&u?a.default.join(l,u):l||u}},86554:(e,t,n)=>{"use strict";var r=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(35747)),o=r(n(85622)),i=n(31669),s=n(58933),d=r(n(41698)),c=n(36414);const u=(0,d.default)("renderer:fs");let l=0;function f(e,t){return new Promise((n=>{const r=l++;s.ipcRenderer.once(`internal-ipc-api-reply:${e}:${r}`,((e,{data:t=null})=>{n(t)})),s.ipcRenderer.send(`internal-ipc-api:${e}`,{payload:t,seq:r})}))}async function p(e){return f("OBTAIN_READ_ACCESS",e)}async function w(e){return f("RELEASE_READ_ACCESS",e)}async function m(e){return f("OBTAIN_WRITE_ACCESS",e)}async function h(e){return f("RELEASE_WRITE_ACCESS",e)}var g={read:async function(e){if(!o.default.isAbsolute(e))throw new Error("Must be an absolute path.");const t=await async function(e){return f("OBTAIN_READ_LOCK",e)}(e);try{return await(0,i.promisify)(a.default.readFile)(e)}catch(t){u.error(`path(${e}) read error: ${(0,c.normalizeError)(t)}`);try{if(!await p(e))throw new Error(`No access to '${e}'`);return await(0,i.promisify)(a.default.readFile)(e)}catch(e){throw e}finally{await w(e)}}finally{await async function(e){return f("RELEASE_READ_LOCK",e)}(t)}},write:async function(e,t){if(!o.default.isAbsolute(e))throw new Error("Must be an absolute path.");const n=await async function(e){return f("OBTAIN_WRITE_LOCK",e)}(e);try{return await(0,i.promisify)(a.default.writeFile)(e,t)}catch(n){u.error(`path(${e}) write error: ${(0,c.normalizeError)(n)}`);try{if(!await m(e))throw new Error(`No access to '${e}'`);return await(0,i.promisify)(a.default.writeFile)(e,t)}catch(e){throw e}finally{await h(e)}}finally{await async function(e){return f("RELEASE_WRITE_LOCK",e)}(n)}},bindBookmark:async function({fp:e,bookmark:t}={}){return f("BIND_BOOKMARK",{fp:e,bookmark:t})},obtainReadAccessFromOS:p,releaseReadAccessFromOS:w,obtainWriteAccessFromOS:m,releaseWriteAccessFromOS:h};t.default=g},2286:(e,t,n)=>{"use strict";var r=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(28147));const o=(0,r(n(41698)).default)("ipc:proxy:");var i=new Proxy(a.default,{get(e,t){let n=Reflect.get(e,t);return"function"==typeof n?(...r)=>{if(!window.isDestroyed)return n.apply(e,r);o.error(`window has been destroyed, we should not invoke fsp.${t})`)}:n}});t.default=i},58587:(e,t,n)=>{"use strict";var r=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(58933);const o=(0,r(n(41698)).default)("ipc:proxy:");var i=new Proxy(a.ipcRenderer,{get(e,t){let n=Reflect.get(e,t);return"function"==typeof n?(...r)=>{if(!window.isDestroyed)return n.apply(e,r);o.error(`window has been destroyed, we should not invoke ipcRenderer.${t} with args (${JSON.stringify(r)})`)}:n}});t.default=i},24678:(e,t,n)=>{"use strict";var r=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.fetch=d,t.route=c,t.default=void 0;var a=n(36414),o=r(n(58587));const i=new Map;let s=0;function d(e,t){const n=i.get(e);return n?Promise.resolve().then((()=>n(t))):new Promise(((n,r)=>{const i=s++;o.default.once(`ipc-api-reply:${e}:${i}`,((e,{error:t=null,data:o=null})=>{t?r((0,a.constructError)(t)):n(o)})),o.default.send(`ipc-api:${e}`,{payload:t,seq:i})}))}function c(e,t){if("function"!=typeof t)throw new Error(`IPC API "${e}" is routed to invalid handler: ${typeof t}`);if(i.has(e))throw new Error(`IPC API "${e}" is routed twice`);const n=`ipc-api:${e}`;if(o.default.eventNames().includes(n))throw new Error(`IPC API "${e}" is routed twice`);const r=(n,{payload:r=null,seq:i=0}={})=>{const s=`ipc-api-reply:${e}:${i}`;Promise.resolve().then((()=>t(r))).then((e=>{o.default.send(s,{data:e})})).catch((e=>{o.default.send(s,{error:(0,a.normalizeError)(e)})}))};return i.set(e,t),o.default.on(n,r),o.default.send("ipc-api-register",{apiName:e}),()=>{o.default.send("ipc-api-unregister",{apiName:e}),o.default.removeListener(n,r),i.delete(e)}}var u={fetch:d,route:c};t.default=u},41698:(e,t,n)=>{"use strict";var r=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.sendLogEvent=d,t.default=t.rootLogger=t.consoleHandler=void 0;var a=n(27398),o=n(36414),i=r(n(60226)),s=n(58933);function d(e){s.ipcRenderer.send("logger:handleLogEvent",e)}const c=new a.ConsoleLogHandler(global.console,{colorful:!1});t.consoleHandler=c;const u=new a.Logger({isDebugging:(0,i.default)("version").indexOf("-alpha")>=0||(0,i.default)("version").indexOf("-dev")>=0||o.isDebugging,handle(e){c.handle(e),d(e)}});t.rootLogger=u;t.default=(e=null)=>u.logger(e)},60226:(e,t,n)=>{"use strict";var r=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e=null){s||(s=JSON.parse(o.default.readFileSync(a.default.join((0,i.getAppPath)(),"package.json"))));return e?s[e]:s};var a=r(n(85622)),o=r(n(35747)),i=n(6921);let s=null},53305:(e,t,n)=>{"use strict";var r=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.toURL=function(e){0;return"file://"+a.default.join((0,i.getAppPath)(),e)},t.toURLInAppData=function(e){return"file://"+a.default.join((0,i.getAppDataPath)(),e)},t.load=function(e){0;return o.default.readFile(a.default.join((0,i.getAppPath)(),e))};var a=r(n(85622)),o=r(n(2286)),i=n(6921)},79914:(e,t,n)=>{"use strict";var r=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(28614)),o=r(n(58587));const i=new a.default,s=i.emit;i.emit=function(e,...t){s.call(i,e,...t),c(e)&&o.default.send("revents:broadcast",[e,...t])},i.on("newListener",(e=>{if(c(e)){0===i.eventNames().filter(c).length&&o.default.send("revents:register")}})),i.on("removeListener",(e=>{if(c(e)){0===i.eventNames().filter(c).length&&o.default.send("revents:unregister")}}));const d=i.removeAllListeners;function c(e){return"newListener"!==e&&"removeListener"!==e}i.removeAllListeners=function(e){if(!e)throw new Error("revents's removeAllListeners is forbidden!");if("newListener"===e||"removeListener"===e)throw new Error('revents\'s "newListener" and "removeListener" handler should not be removed');d.call(i,e)},o.default.on("revents:broadcast",((e,t)=>{let n=JSON.parse(t);s.apply(i,n)})),window.addEventListener("unload",(()=>{o.default.send("revents:unregister")}));var u=i;t.default=u},83450:(e,t,n)=>{"use strict";var r=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.trackEvent=function(e){a.default.send("usage-tracker:track-event",{event:e})},t.trackView=function(e){a.default.send("usage-tracker:track-view",{view:e})},t.trackConfig=function(e){a.default.send("usage-tracker:track-config",{config:e})};var a=r(n(58587))},6921:(e,t,n)=>{"use strict";var r=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.getRootPath=s,t.getAppPath=c,t.getTempPath=function(){u||(u=o.ipcRenderer.sendSync("workspace:tempPath"));return u},t.getAppDataPath=l,t.getWorkbooksPath=function(){return a.default.join(l(),"workbooks")},t.getFileCachePath=function(){return a.default.join(l(),"file-cache")},t.getThemePath=function(){return a.default.join(l(),"theme")},t.getResourceBasePath=function(){return a.default.join(c(),"static/snowbird/resource/")};var a=r(n(85622)),o=n(58933);let i=null;function s(){return i||(i=o.ipcRenderer.sendSync("workspace:userData")),i}let d=null;function c(){return d||(d=o.ipcRenderer.sendSync("workspace:appPath")),d}let u=null;function l(){return a.default.join(s(),"vana")}},96310:(e,t,n)=>{"use strict";var r=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(71191)),o=r(n(12087)),i=r(n(41698)),s=r(n(79932));const d=(0,i.default)("performance");function c(e){e?document.body.style.setProperty("--uk-system-accent-color",e):document.body.style.removeProperty("--uk-system-accent-color")}t.default=()=>e=>{const{_apr:t,_acc:n}=a.default.parse(location.search.slice(1));t&&(e.commit("bootstrap/startJob"),d.debug("About to load CSS using _apr query parameter:",t),(0,s.default)(t,(()=>{d.debug("Loaded CSS using _apr query parameter:",t),setTimeout((()=>{e.commit("bootstrap/endJob")}),10)}))),n&&c(n),"darwin"===o.default.platform()&&parseFloat(o.default.release())>=20&&document.body.classList.add("uk-darwin-bigsur");let r=e.watch((e=>e.sync.ready),(t=>{t&&(r(),e.watch(((e,t)=>t["preferences/appearance"]),(t=>{(0,s.default)(t),setTimeout((()=>{e.commit("forceUpdate")}),50)})),e.watch((e=>e.app.systemAccentColor),(e=>c(e))),e.watch((e=>e.preferences.systemScrollbarSetting),(e=>function(e){const t="uk-global-scrollbar";document.body.classList.forEach((e=>{e.startsWith(t)&&document.body.classList.remove(e)})),document.body.classList.add(`${t}-${(e||"always").toLowerCase()}`)}(e)),{immediate:!0}))}))}},80969:(e,t,n)=>{"use strict";var r=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(48932),o=(r(n(41698)),n(83450)),i=r(n(24678)),s=n(99492);t.default=()=>e=>{Object.keys(a.LIMITED_TRIAL_FEATURE_COMMANDS_TO_FEATURE_NAMES).concat(Object.keys(a.UNLIMITED_TRIAL_FEATURE_COMMANDS_TO_FEATURE_NAMES)).forEach((t=>{e.appendBeforeHandler(t,(()=>(async e=>{if(!await i.default.fetch(s.FEATURE_TRIAL_REQUEST,e))return"interruption"})(t)))})),a.NEW_TOPIC_COMMANDS.forEach((t=>{e.appendAfterHandler(t,(()=>{const e=t.split(".")[1];(0,o.trackEvent)({eventCategory:"Edit",eventAction:e,eventValue:1})}))})),a.SHARE_COMMANDS.forEach((t=>{e.appendAfterHandler(t,(()=>{(0,o.trackEvent)({eventCategory:"Share",eventAction:t,eventValue:1})}))}))}},50766:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=()=>e=>{e.registerModule("bootstrap",{namespaced:!0,state:{pendingJobs:0,ready:!1},mutations:{startJob:e=>{e.pendingJobs+=1},endJob:e=>{e.pendingJobs-=1},ready:e=>{e.ready=!0}}}),e.commit("bootstrap/startJob");let t=e.watch((e=>e.bootstrap.pendingJobs),(n=>{n>0||(t(),e.commit("bootstrap/ready"))}));setTimeout((()=>{e.commit("bootstrap/endJob")}),0)}},29781:(e,t,n)=>{"use strict";var r=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(59713)),o=n(99492),i=n(23074),s=r(n(24678)),d=r(n(79914)),c=n(28441);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){(0,a.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.default=({modules:e={},namespaceMapping:t={}}={})=>n=>{const r=Object.keys(e),a={};for(let e in t)a[t[e]]=e;let u=!1,f=[];function p({type:e,payload:a}){if(u)return;let i=e.split("/");if(!r.concat(n.state.sync.dynamicModuleNames).includes(i[0]))return;if(i[i.length-1].startsWith("muted:"))return;i[0]in t&&(i[0]=t[i[0]],e=i.join("/"));let d=JSON.stringify(a);f.push({type:e,payload:a?JSON.parse(d):void 0}),1===f.length&&(0,c.nextTick)((()=>{s.default.fetch(o.STORE_UPDATE_STATE,{mutations:f}),f.length=0}))}n.registerModule("sync",{namespaced:!0,state:{ready:!1,dynamicModuleNames:[]},mutations:{ready(e){e.ready=!0},updateDynamicModules(e,{namespaceArr:t=[]}){e.dynamicModuleNames=t}},actions:{registerModules({state:e,commit:t},{modules:r={}}={}){let a=Object.keys(r);return a=a.filter((t=>!e.dynamicModuleNames.includes(t))),a.length>0?s.default.fetch(o.STORE_GET_STATE).then((o=>{a=a.filter((t=>!e.dynamicModuleNames.includes(t))),a.length>0&&n.replaceState(l(l({},n.state),a.reduce(((e,t)=>(e[t]=o[t],e)),{}))),t("updateDynamicModules",{namespaceArr:[...e.dynamicModuleNames,...a]}),a.forEach((e=>n.registerModule(e,r[e],{preserveState:!0})))})):Promise.resolve()},unregisterModules:({commit:e,state:t},{namespaceArr:r=[]})=>(r.length&&(e("updateDynamicModules",{namespaceArr:t.dynamicModuleNames.filter((e=>!r.includes(e)))}),r.forEach((e=>n.unregisterModule(e)))),Promise.resolve())}}),n.commit("bootstrap/startJob"),s.default.fetch(o.STORE_GET_STATE).then((o=>{let s=Object.assign({},n.state);for(let n in e){let e=t[n]||n;e in o&&(s[n]=o[e])}n.replaceState(s);const c=n.subscribe(p);n.watch((()=>window.isBeingDestroyed),(e=>{e&&c&&c()}),{sync:!0}),d.default.on(i.STORE_DID_UPDATE_STATE,(e=>{u=!0,e.forEach((({type:e,payload:t})=>{let o=e.split("/");o[0]in a&&(o[0]=a[o[0]],e=o.join("/")),r.concat(n.state.sync.dynamicModuleNames).includes(o[0])&&n.commit(e,t)})),u=!1})),n.commit("sync/ready"),n.commit("bootstrap/endJob")})).catch((()=>{}))}},79932:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t=null){const n=document.querySelector("#appearance_link");if(n&&n.getAttribute("data-appearance")===e)return void("function"==typeof t&&t());const a=(0,r.toURL)(`static/vanakit/themes/${encodeURIComponent(e)}.css`),o=document.createElement("link");o.type="text/css",o.id="appearance_link",o.rel="stylesheet",o.href=a,o.setAttribute("data-appearance",e),"function"==typeof t&&(o.onload=()=>t());document.head.appendChild(o),n&&n.parentElement&&n.parentElement.removeChild(n)};var r=n(53305)},28441:(e,t,n)=>{"use strict";var r=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.getMaxDPIRatio=w,t.percentageNumberFromPercentageString=function(e){let t=parseInt(e);return Number.isInteger(t)?t:100},t.percentageStringFromPercentageNumber=function(e){return`${parseInt(e)}%`},t.saveAs=async function(e,t,n){h(e,n).then((function(e){o.default.copyFileSync(t,e)}))},t.saveAsImageData=async function(e,t,n,r=1){h(e,n).then((function(e){o.default.writeFileSync(e,m(t,r))}))},t.nextTick=function(e){process&&process.nextTick?process.nextTick(e):Promise.resolve().then(e)},t.dive=function e(t,...n){if(!t||!n.length)return t;const[r,...a]=n;return e(t[r],...a)},t.wrappedTooltipWithKeybinding=function(e,t){let n=this.$store.getters["keybindings/keybindingByCommandIdAndGroup"](t);const r=[];return"string"==typeof n&&n.split("+").forEach((e=>{let t=e;"darwin"===process.platform&&(t=u.MAC_MODIFIER_ICON[t]||t),"="===t&&(t="+"),t&&r.push(t)})),r.length>0?`${e} ${r.join(" ")}`:e},t.rotateBase64Image90deg=function(e,t){const n=document.createElement("canvas"),r=n.getContext("2d"),a=new Image;a.src=e,n.height=a.width,n.width=a.height,t?(r.rotate(90*Math.PI/180),r.translate(0,-n.width)):(r.rotate(-90*Math.PI/180),r.translate(-n.height,0));return r.drawImage(a,0,0),n.toDataURL("image/png")},t.flipBase64Image=function(e,t){const n=document.createElement("canvas"),r=n.getContext("2d"),a=new Image;a.src=e,n.height=a.height,n.width=a.width,t?(r.translate(n.width,0),r.scale(-1,1)):(r.translate(0,n.height),r.scale(1,-1));return r.drawImage(a,0,0),n.toDataURL("image/png")},t.rotateSVG=async function(e,t){if(!o.default.existsSync(e))return console.error(`${e} not exists`),null;const n=await o.default.readFile(e,"utf8");return(e=>{const n=function(e){return e.includes(y)}(e),r={rotate:0,translateX:0,translateY:0,width:null,height:null},a={width:null,height:null};let o=(0,f.default)().use((e=>{if(n)e.match({tag:"svg",attrs:{name:y}},(e=>(r.width=e.attrs.width,r.height=e.attrs.height,e))),e.match({tag:"g",attrs:{name:v}},(e=>{a.width=parseFloat(e.attrs.originWidth),a.height=parseFloat(e.attrs.originHeight);const{transform:t}=e.attrs,n=t.match(/rotate\(([-\d]*?)\)/);n&&n[1]&&(r.rotate=parseFloat(n[1]));const o=t.match(/translate\(([-\d]*?) ([-\d]*?)\)/);return o&&o[1]&&o[2]&&(r.translateX=parseFloat(o[1]),r.translateY=parseFloat(o[2])),e}));else{let t=!1;e.match({tag:"svg"},(e=>(t||(r.width=a.width=parseFloat(e.attrs.width),r.height=a.height=parseFloat(e.attrs.height)),e)))}})).process(e,{sync:!0}).html;n||(o=function(e){return`<svg name="XMind-svg-transform-container-svg"><g name="XMind-svg-transform-container-g">${e}</svg>`}(o));const i={rotate:r.rotate+(t?90:-90),width:r.height,height:r.width};return o=(0,f.default)().use((e=>{e.match({tag:"g",attrs:{name:v}},(e=>{const t=a.width/2,n=a.height/2;e.attrs["transform-origin"]||(e.attrs["transform-origin"]=a.width/2+" "+a.height/2),e.attrs.originWidth=a.width,e.attrs.originHeight=a.height;const r={x:-1,y:-1},o={x:-1*(s=function(e,t){const n=t*(Math.PI/180);return{x:e.x*Math.cos(n)+e.y*Math.sin(n),y:-1*e.x*Math.sin(n)+e.y*Math.cos(n)}}(r,i.rotate)).x,y:-1*s.y};var s;let d=`translate(${r.x*t} ${r.y*n}) rotate(${i.rotate}) translate(${o.x*t} ${o.y*n})`;return e.attrs.transform=d,e}))})).use((e=>{e.match({tag:"svg",attrs:{name:y}},(e=>(e.attrs.xmlns||(e.attrs.xmlns="http://www.w3.org/2000/svg"),e.attrs.width=i.width,e.attrs.height=i.height,e.attrs.viewBox=`0 0 ${i.width} ${i.height}`,e)))})).process(o,{sync:!0}).html,o})(n)},t.getScreenDPI=t.getAdaptedScreenMaxDPIPngBuffer=t.createGetTextWidthFunction=t.luminance=void 0;var a=n(95287),o=r(n(28147)),i=r(n(24678)),s=n(99492),d=r(n(85622)),c=n(58933),u=n(48932),l=n(41809),f=r(n(87525));const p={cache:!1};t.luminance=e=>{const t=e=>parseInt(e,16);if("string"==typeof e&&/^#[A-Z0-9]{6}$/.test(e.toUpperCase())){return.2126*t(e.slice(1,3))+.7152*t(e.slice(3,5))+.0722*t(e.slice(5))}return 0};function w(){const e=c.remote.screen.getAllDisplays().map((e=>e.scaleFactor));return Math.max.apply(null,e)}t.createGetTextWidthFunction=(e={})=>{const t=Object.assign({},p,e);let n=null;const r={};return function(e="",a=""){if(t.cache&&r[e])return r[e];n||(n=document.createElement("canvas"));const o=n.getContext("2d");o.font=a;const i=o.measureText(e);return t.cache&&(r[e]=i.width),i.width}};const m=(e,t=1)=>{const n=w(),r=(0,l.changeDpiDataUrl)(e,72*n*t);return Buffer.from(r.slice("data:image/png;base64,".length),"base64")};async function h(e,t){let n="";try{n=e.state.attachment.lastSaveDirectory||c.remote.app.getPath("downloads")}catch(e){n="downloads"}const r=await(0,a.showSaveDialog)({title:"Save",suggestPath:{store:e,suggestedName:t,defaultPath:n}});return new Promise((function(e){if(r){const t=d.default.dirname(r);i.default.fetch(s.STORE_COMMIT,{mutations:[{type:"attachment/setLastDirectory",payload:{lastSaveDirectory:t}}]}),e(r)}}))}t.getAdaptedScreenMaxDPIPngBuffer=m;const g=function(){let e=null;return function(){if(!e)if(window.screen.deviceXDPI&&window.screen.deviceYDPI)e={x:window.screen.deviceXDPI,y:window.screen.deviceYDPI};else{const t=document.createElement("div");t.style.cssText="width:1in;height:1in;position:absolute;left:0px;top:0px;z-index:99;visibility:hidden",document.body.appendChild(t),e={x:parseInt(t.offsetWidth),y:parseInt(t.offsetHeight)},t.parentNode.removeChild(t)}return e}}();t.getScreenDPI=g;const y="XMind-svg-transform-container-svg",v="XMind-svg-transform-container-g"}}]);