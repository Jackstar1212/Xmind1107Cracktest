(global.webpackChunkxmind_vana=global.webpackChunkxmind_vana||[]).push([[6103],{11116:(e,t,r)=>{"use strict";var i=r(95318);Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var a=i(r(59713)),s=i(r(7322)),n=i(r(58202)),c=r(20629);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){(0,a.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var l={mixins:[s.default,n.default],data(){return{illustrationImageURL:this.$toResourceURL("static/assets/images/license-dialog-illustration.svg")}},computed:u(u({},(0,c.mapGetters)("preferences",["appearance"])),{},{touchBarItems(){return[{type:"space",size:"flexible"},{type:"button",label:this.$T("Cancel"),click:"close"},{type:"button",label:this.$T("Activate"),backgroundColor:"primary",click:"activate"},{type:"space",size:"flexible"}]}})};t.Z=l},58202:(e,t,r)=>{"use strict";var i=r(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(r(59713)),s=r(20629),n=r(48932),c=r(67623),o=r(99492),u=i(r(24678));function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){(0,a.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const _=[n.PER_MACHINE_LICENSE_SERVER_STATUS.E_KEY_BIND_TO_ANOTHER_MACHINE,n.PER_MACHINE_LICENSE_SERVER_STATUS.E_KEY_NOT_EXIST];var E={data:()=>({licenseKey:"",email:"",validity:n.PER_MACHINE_LICENSE_VALIDITY.VALID,serverStatus:n.PER_MACHINE_LICENSE_SERVER_STATUS.VALID,activating:!1}),computed:d(d({},(0,s.mapGetters)("activation",["validatePerMachineLicenseKey","parsePerMachineLicenseData","validatePerMachineLicenseData"])),{},{canActivate(){return this.licenseKey&&this.email&&!this.activating},errMsg(){if(this.validity!==n.PER_MACHINE_LICENSE_VALIDITY.VALID){switch(this.validity){case n.PER_MACHINE_LICENSE_VALIDITY.E_KEY_INVALID:return this.$T("Invalid license. Please enter a correct email and key.");case n.PER_MACHINE_LICENSE_VALIDITY.E_OUTDATED:return this.$T("Please enter a valid license key.");case n.PER_MACHINE_LICENSE_VALIDITY.E_MAJOR_VERSION_UNMATCHED:return this.$T("This license key cannot be used in this version of XMind.");case n.PER_MACHINE_LICENSE_VALIDITY.E_MACHINE_ID_UNMATCHED:return this.$T("Failed to obtain device information to bind to this license key.")}return this.$T("Unexpected error occurred during activating license.")}if(this.serverStatus!==n.PER_MACHINE_LICENSE_SERVER_STATUS.VALID){switch(this.serverStatus){case n.PER_MACHINE_LICENSE_SERVER_STATUS.E_KEY_BIND_TO_ANOTHER_MACHINE:return this.$T("This license key is already bound with another device.");case n.PER_MACHINE_LICENSE_SERVER_STATUS.E_KEY_NOT_EXIST:return this.$T("Activation failed, please check your Email and license key.");case n.PER_MACHINE_LICENSE_SERVER_STATUS.E_PARAM_MISSING:return this.$T("Unexpected error occurred during activating license.");case n.PER_MACHINE_LICENSE_SERVER_STATUS.E_SERVER_ERR:return this.$T("Can't connect with XMind server, please try again later.")}return this.$T("Network error or other unexpected error. Please try again later.")}return""}}),methods:{submitForm(e){return e.preventDefault(),e.returnValue=!1,this.$safeRun((()=>this.activate())),!1},async activate(){if(this.canActivate){this.activating=!0;try{this.validity=n.PER_MACHINE_LICENSE_VALIDITY.VALID,this.serverStatus=n.PER_MACHINE_LICENSE_SERVER_STATUS.VALID;const e=(0,c.trimLicenseKey)(this.licenseKey),t=this.email.trim();let r;try{r=await u.default.fetch(o.XOS.SME_LICENSE_ACTIVATE,{key:e,email:t})}catch(i){if(_.includes(i.code))return void(this.serverStatus=i.code);r={key:e,email:t}}try{let e=this.parsePerMachineLicenseData(r);this.validity=this.validatePerMachineLicenseData(e)}catch(e){this.validity=n.PER_MACHINE_LICENSE_VALIDITY.E_KEY_INVALID}if(this.validity!==n.PER_MACHINE_LICENSE_VALIDITY.VALID)return;await Promise.all([u.default.fetch(o.STORE_COMMIT,{mutations:[{type:"activation/updateRawPerMachineLicenseData",payload:{rawData:d(d({},r),{},{email:t})}}]}),u.default.fetch((0,o.WINDOW_SUBMIT_RESULT)(window.id),{success:!0})]),setTimeout((()=>window.close()),0),await u.default.fetch(o.WINDOW_OPEN,{name:"dialog-congratulate"})}finally{this.activating=!1}}}}};t.default=E},7322:(e,t,r)=>{"use strict";var i=r(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(r(59713)),s=r(48932),n=r(99492),c=r(36414),o=i(r(24678));function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){(0,a.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d={computed:{},watch:{touchBarItems(e){this.updateTouchBarItems(e)}},methods:{updateTouchBarItems(e){const t=e=>{const t=e.click;let r=this._touchBarRoutes[t];return r||(r={method:t,endpoint:(0,n.WINDOW_CALLBACK)(window.id,(0,c.hyphenate)(t))},this._touchBarRoutes[t]=r),r.unroute||(r.unroute=o.default.route(r.endpoint,this[t])),Object.assign({},e,{click:r.endpoint})};e=(e||this.touchBarItems||[]).map((e=>("button"!==e.type||"string"!=typeof e.click||s.WINDOW_ACTIONS.includes(e.click)||e.click.startsWith("command:")?"buttons"===e.type&&(e=l(l({},e),{},{buttons:e.buttons.map((e=>"string"!=typeof e.click||s.WINDOW_ACTIONS.includes(e.click)||e.click.startsWith("command:")?e:t(e)))})):e=t(e),e))),this.$store.commit("window/updateTouchBarItems",{items:e})}},beforeCreate(){this._touchBarRoutes={}},mounted(){this.updateTouchBarItems()},beforeDestroy(){Object.values(this._touchBarRoutes).forEach((({unroute:e})=>e&&e())),this._touchBarRoutes={}}};t.default=d},78198:(e,t,r)=>{"use strict";var i=r(95318),a=i(r(2872)),s=i(r(59624));(0,a.default)(s.default,{name:"dialog-license"})},59624:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__esModule:()=>i.X,default:()=>a});var i=r(11116);const a=(0,r(62236).Z)(i.Z,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"uk-window uk-window-default uk-window-dialog",attrs:{id:"app"}},[r("div",{staticClass:"uk-window-title-bar uk-window-title-bar-floating"},[r("window-control-button-group")],1),e._v(" "),r("div",{staticClass:"uk-window-body uk-flex uk-child-width-expand"},[r("article",{staticClass:"uk-flex uk-height-1-1"},[r("div",{staticClass:"uk-height-1-1 uk-flex-no-shrink"},[r("div",{staticClass:"uk-preserve uk-height-1-1 uk-text-center",attrs:{"uk-svg":"ratio:1","data-src":e.illustrationImageURL}})]),e._v(" "),r("div",{staticClass:"uk-width-expand uk-margin-large-top  uk-margin-large-bottom uk-padding-large"},[r("div",{staticClass:"uk-height-1-1 uk-flex uk-flex-column"},[r("h1",{staticClass:"uk-margin-bottom"},[e._v("\n            "+e._s(e.$T("Enter License"))+"\n          ")]),e._v(" "),r("div",[e._v("\n            "+e._s(e.$T("Enter license to activate your XMind on this device."))+"\n          ")]),e._v(" "),r("form",{staticClass:"uk-form-stacked",staticStyle:{"margin-top":"40px"},attrs:{id:"per_machine_license_form"},on:{submit:function(t){return t.preventDefault(),e.submitForm(t)}}},[r("div",{staticClass:"uk-margin"},[r("label",{staticClass:"uk-form-label"},[e._v(e._s(e.$T("Email")+e.$T(":")))]),e._v(" "),r("div",{staticClass:"uk-form-controls"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],staticClass:"uk-input uk-form-large",attrs:{type:"text",autofocus:""},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}})])]),e._v(" "),r("div",{staticClass:"uk-margin uk-margin-remove-bottom"},[r("label",{staticClass:"uk-form-label"},[e._v(e._s(e.$T("License Key")+e.$T(":")))]),e._v(" "),r("div",{staticClass:"uk-form-controls"},[r("textarea",{directives:[{name:"model",rawName:"v-model",value:e.licenseKey,expression:"licenseKey"}],staticClass:"uk-textarea uk-form-large",staticStyle:{height:"122px"},domProps:{value:e.licenseKey},on:{input:function(t){t.target.composing||(e.licenseKey=t.target.value)}}})])])]),e._v(" "),r("p",{staticClass:"uk-text-danger uk-margin-remove-top"},[e._v("\n            "+e._s(e.errMsg||"Â ")+"\n          ")]),e._v(" "),r("button",{staticClass:"uk-button uk-button-primary uk-button-large uk-width",attrs:{type:"submit",form:"per_machine_license_form",disabled:!e.canActivate}},[e.activating?r("span",{staticClass:"uk-margin-small-right",attrs:{"uk-spinner":"ratio: 0.6"}}):e._e(),e._v("\n            "+e._s(e.$T("Activate"))+"\n          ")])])])])])])}),[],!1,null,null,null).exports},76417:e=>{"use strict";e.exports=require("crypto")},58933:e=>{"use strict";e.exports=require("electron")},28614:e=>{"use strict";e.exports=require("events")},35747:e=>{"use strict";e.exports=require("fs")},12087:e=>{"use strict";e.exports=require("os")},85622:e=>{"use strict";e.exports=require("path")},87525:e=>{"use strict";e.exports=require("posthtml")},71191:e=>{"use strict";e.exports=require("querystring")},31669:e=>{"use strict";e.exports=require("util")}},e=>{"use strict";e.O(0,[8592,5586,4736,2872],(()=>{return t=78198,e(e.s=t);var t}));var t=e.O();module.exports=t}]);