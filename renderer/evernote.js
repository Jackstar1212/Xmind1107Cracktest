(global.webpackChunkxmind_vana=global.webpackChunkxmind_vana||[]).push([[208],{61405:(e,t,r)=>{"use strict";var i=r(95318);Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var n=i(r(59713)),s=i(r(78835)),o=i(r(52624)),a=i(r(24678)),u=r(99492),c=i(r(41698)),l=r(36414);function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const p="http://localhost/oauth_callback",v=(0,c.default)("evernote");var f={data:()=>({showSpinner:!1,oathURL:"",china:!1,evernoteClient:null,oauthToken:"",oauthTokenSecret:""}),mounted(){this.getOauthURL()},methods:{switchToChina(e){this.china=e,this.showSpinner=!1,this.getOauthURL()},handleAuthorization({target:e}){this.showSpinner=!1;const t=e.getURL();if(0!==t.indexOf(p))return;const r=s.default.parse(t,!0).query.oauth_verifier;r?this.evernoteClient.getAccessToken(this.oauthToken,this.oauthTokenSecret,r,((e,t)=>{this.$safeRun((async()=>{this.evernoteClient=new o.default.Client({token:t,sandbox:!1,china:this.china});const e=this.evernoteClient.getUserStore(),r=await e.getUser();a.default.fetch(u.STORE_COMMIT,{mutations:[{type:"evernote/updateEvernote",payload:d({oauthToken:t,china:this.china},r)}]}).then((()=>{window.close()}))}))})):window.close()},getOauthURL(){try{this.evernoteClient=new o.default.Client({consumerKey:"xmind",consumerSecret:"ee87a7c738511e29",sandbox:!1,china:this.china}),this.evernoteClient.getRequestToken(p,((e,t,r)=>{e?v.error("Request token error: %s",(0,l.normalizeError)(e)):(this.oauthToken=t,this.oauthTokenSecret=r,this.oathURL=this.evernoteClient.getAuthorizeUrl(t))}))}catch(e){throw e}}}};t.Z=f},59514:(e,t,r)=>{"use strict";var i=r(95318),n=i(r(2872)),s=i(r(56338));(0,n.default)(s.default,{name:"evernote"})},56338:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__esModule:()=>i.X,default:()=>n});var i=r(61405);const n=(0,r(62236).Z)(i.Z,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"uk-window uk-window-dialog",attrs:{id:"app"}},[r("div",{staticClass:"uk-window-title-bar"},[r("div",{staticClass:"uk-window-title"},[e._v("Evernote")]),e._v(" "),r("window-control-button-group")],1),e._v(" "),r("div",{staticClass:"uk-window-body uk-flex uk-flex-column"},[r("ul",{staticClass:"uk-tab uk-tab-contained uk-flex uk-flex-center",attrs:{"uk-tab":""}},[r("li",{staticClass:"uk-active",attrs:{"aria-expanded":"true"},on:{click:function(t){return e.switchToChina(!1)}}},[r("a",[e._v("Evernote")])]),e._v(" "),r("li",{attrs:{"aria-expanded":"false"},on:{click:function(t){return e.switchToChina(!0)}}},[r("a",[e._v("印象笔记")])])]),e._v(" "),r("div",{staticClass:"uk-flex-1 uk-flex uk-position-relative"},[r("webview",{key:e.oathURL,staticClass:"uk-flex-1",attrs:{src:e.oathURL,partition:"evernote"},on:{"did-finish-load":function(t){return e.handleAuthorization(t)},"did-start-loading":function(t){e.showSpinner=!0},"did-stop-loading":function(t){e.showSpinner=!1}}}),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.showSpinner,expression:"showSpinner"}],staticClass:"uk-background-default uk-position-cover uk-flex uk-flex-1 uk-flex-center uk-flex-middle",staticStyle:{color:"#00c253"}},[r("div",{attrs:{"uk-spinner":"ratio: 4;"}})])],1)])])}),[],!1,null,null,null).exports},76417:e=>{"use strict";e.exports=require("crypto")},58933:e=>{"use strict";e.exports=require("electron")},28614:e=>{"use strict";e.exports=require("events")},52624:e=>{"use strict";e.exports=require("evernote")},35747:e=>{"use strict";e.exports=require("fs")},12087:e=>{"use strict";e.exports=require("os")},85622:e=>{"use strict";e.exports=require("path")},87525:e=>{"use strict";e.exports=require("posthtml")},71191:e=>{"use strict";e.exports=require("querystring")},78835:e=>{"use strict";e.exports=require("url")},31669:e=>{"use strict";e.exports=require("util")}},e=>{"use strict";e.O(0,[8592,5586,4736,2872],(()=>{return t=59514,e(e.s=t);var t}));var t=e.O();module.exports=t}]);